{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/\\uAE40\\uC544\\uB984/Desktop/index/instagram/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _regeneratorRuntime from\"C:/Users/\\uAE40\\uC544\\uB984/Desktop/index/instagram/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/\\uAE40\\uC544\\uB984/Desktop/index/instagram/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/\\uAE40\\uC544\\uB984/Desktop/index/instagram/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject,_templateObject2,_templateObject3;import{useState}from\"react\";import{useNavigate}from\"react-router\";import styled from\"styled-components\";import{createPost}from\"../../api/auth\";import Button from\"../common/Button\";import ImageCrop from\"../common/ImageCrop\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function PostEdit(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var _useState5=useState({url:\"\",filename:\"\"}),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),body=_useState8[0],setBody=_useState8[1];var navigate=useNavigate();// 자른 파일 받아서 url, filename 업데이트\nvar handleCrop=function handleCrop(e){var reader=new FileReader();reader.onload=function(){setImage({url:reader.result,filename:e.target.files[0].name});setOpen(true);};reader.readAsDataURL(e.target.files[0]);};var handleImage=function handleImage(file){setFile(file);var reader=new FileReader();reader.onload=function(){setImage({url:reader.result,filename:file.name});setOpen(false);};reader.readAsDataURL(file);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var form;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:form=new FormData();form.append(\"files\",file);form.append(\"body\",body);_context.next=5;return createPost(form);case 5:navigate(\"/post\");case 6:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",style:{display:\"none\"},id:\"image\",onChange:handleCrop}),/*#__PURE__*/_jsx(PreviewBox,{htmlFor:\"image\",children:/*#__PURE__*/_jsx(\"img\",{src:image.url,alt:\"\"})}),/*#__PURE__*/_jsx(InputBody,{onChange:function onChange(e){return setBody(e.target.value);}}),/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,children:\"Submit\"})]}),open&&/*#__PURE__*/_jsx(ImageCrop,{closeModal:function closeModal(){return setOpen(false);},originalUrl:image.url,onSubmit:handleImage,filename:image.filename})]});}var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n  height: 100vh;\\n\"])));var PreviewBox=styled.label(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 200px;\\n  height: 200px;\\n  border: 2px solid \",\";\\n  margin-bottom: 20px;\\n  cursor: pointer;\\n  overflow: hidden;\\n\\n  img {\\n    width: 100%;\\n  }\\n\"])),function(_ref2){var theme=_ref2.theme;return theme.colors.bd_color;});var InputBody=styled.textarea(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  resize: none;\\n  width: 200px;\\n  height: 100px;\\n  margin-bottom: 10px;\\n\"])));export default PostEdit;","map":{"version":3,"names":["useState","useNavigate","styled","createPost","Button","ImageCrop","PostEdit","open","setOpen","file","setFile","url","filename","image","setImage","body","setBody","navigate","handleCrop","e","reader","FileReader","onload","result","target","files","name","readAsDataURL","handleImage","handleSubmit","form","FormData","append","display","value","Container","div","PreviewBox","label","theme","colors","bd_color","InputBody","textarea"],"sources":["C:/Users/김아름/Desktop/index/instagram/src/component/post/PostEdit.jsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useNavigate } from \"react-router\";\r\nimport styled from \"styled-components\";\r\nimport { createPost } from \"../../api/auth\";\r\nimport Button from \"../common/Button\";\r\nimport ImageCrop from \"../common/ImageCrop\";\r\n\r\nfunction PostEdit() {\r\n  const [open, setOpen] = useState(false);\r\n  const [file, setFile] = useState(null);\r\n  const [image, setImage] = useState({\r\n    url: \"\",\r\n    filename: \"\",\r\n  });\r\n  const [body, setBody] = useState(\"\");\r\n\r\n  const navigate = useNavigate();\r\n  // 자른 파일 받아서 url, filename 업데이트\r\n\r\n  const handleCrop = (e) => {\r\n    const reader = new FileReader();\r\n\r\n    reader.onload = () => {\r\n      setImage({\r\n        url: reader.result,\r\n        filename: e.target.files[0].name,\r\n      });\r\n      setOpen(true);\r\n    };\r\n\r\n    reader.readAsDataURL(e.target.files[0]);\r\n  };\r\n\r\n  const handleImage = (file) => {\r\n    setFile(file);\r\n    const reader = new FileReader();\r\n\r\n    reader.onload = () => {\r\n      setImage({\r\n        url: reader.result,\r\n        filename: file.name,\r\n      });\r\n      setOpen(false);\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    const form = new FormData();\r\n\r\n    form.append(\"files\", file);\r\n    form.append(\"body\", body);\r\n\r\n    await createPost(form);\r\n\r\n    navigate(\"/post\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Container>\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          style={{ display: \"none\" }}\r\n          id=\"image\"\r\n          onChange={handleCrop}\r\n        />\r\n        <PreviewBox htmlFor=\"image\">\r\n          <img src={image.url} alt=\"\" />\r\n        </PreviewBox>\r\n        <InputBody onChange={(e) => setBody(e.target.value)} />\r\n        <Button onClick={handleSubmit}>Submit</Button>\r\n      </Container>\r\n      {open && (\r\n        <ImageCrop\r\n          closeModal={() => setOpen(false)}\r\n          originalUrl={image.url}\r\n          onSubmit={handleImage}\r\n          filename={image.filename}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100vh;\r\n`;\r\n\r\nconst PreviewBox = styled.label`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 200px;\r\n  height: 200px;\r\n  border: 2px solid ${({ theme }) => theme.colors.bd_color};\r\n  margin-bottom: 20px;\r\n  cursor: pointer;\r\n  overflow: hidden;\r\n\r\n  img {\r\n    width: 100%;\r\n  }\r\n`;\r\n\r\nconst InputBody = styled.textarea`\r\n  resize: none;\r\n  width: 200px;\r\n  height: 100px;\r\n  margin-bottom: 10px;\r\n`;\r\n\r\nexport default PostEdit;\r\n"],"mappings":"0nBAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,WAAW,KAAQ,cAAc,CAC1C,MAAOC,OAAM,KAAM,mBAAmB,CACtC,OAASC,UAAU,KAAQ,gBAAgB,CAC3C,MAAOC,OAAM,KAAM,kBAAkB,CACrC,MAAOC,UAAS,KAAM,qBAAqB,CAAC,6IAE5C,QAASC,SAAQ,EAAG,CAClB,cAAwBN,QAAQ,CAAC,KAAK,CAAC,wCAAhCO,IAAI,eAAEC,OAAO,eACpB,eAAwBR,QAAQ,CAAC,IAAI,CAAC,yCAA/BS,IAAI,eAAEC,OAAO,eACpB,eAA0BV,QAAQ,CAAC,CACjCW,GAAG,CAAE,EAAE,CACPC,QAAQ,CAAE,EACZ,CAAC,CAAC,yCAHKC,KAAK,eAAEC,QAAQ,eAItB,eAAwBd,QAAQ,CAAC,EAAE,CAAC,yCAA7Be,IAAI,eAAEC,OAAO,eAEpB,GAAMC,SAAQ,CAAGhB,WAAW,EAAE,CAC9B;AAEA,GAAMiB,WAAU,CAAG,QAAbA,WAAU,CAAIC,CAAC,CAAK,CACxB,GAAMC,OAAM,CAAG,GAAIC,WAAU,EAAE,CAE/BD,MAAM,CAACE,MAAM,CAAG,UAAM,CACpBR,QAAQ,CAAC,CACPH,GAAG,CAAES,MAAM,CAACG,MAAM,CAClBX,QAAQ,CAAEO,CAAC,CAACK,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,IAC9B,CAAC,CAAC,CACFlB,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAEDY,MAAM,CAACO,aAAa,CAACR,CAAC,CAACK,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CACzC,CAAC,CAED,GAAMG,YAAW,CAAG,QAAdA,YAAW,CAAInB,IAAI,CAAK,CAC5BC,OAAO,CAACD,IAAI,CAAC,CACb,GAAMW,OAAM,CAAG,GAAIC,WAAU,EAAE,CAE/BD,MAAM,CAACE,MAAM,CAAG,UAAM,CACpBR,QAAQ,CAAC,CACPH,GAAG,CAAES,MAAM,CAACG,MAAM,CAClBX,QAAQ,CAAEH,IAAI,CAACiB,IACjB,CAAC,CAAC,CACFlB,OAAO,CAAC,KAAK,CAAC,CAChB,CAAC,CAEDY,MAAM,CAACO,aAAa,CAAClB,IAAI,CAAC,CAC5B,CAAC,CAED,GAAMoB,aAAY,4FAAG,6IACbC,IAAI,CAAG,GAAIC,SAAQ,EAAE,CAE3BD,IAAI,CAACE,MAAM,CAAC,OAAO,CAAEvB,IAAI,CAAC,CAC1BqB,IAAI,CAACE,MAAM,CAAC,MAAM,CAAEjB,IAAI,CAAC,CAAC,sBAEpBZ,WAAU,CAAC2B,IAAI,CAAC,QAEtBb,QAAQ,CAAC,OAAO,CAAC,CAAC,qDACnB,kBATKY,aAAY,0CASjB,CAED,mBACE,wCACE,MAAC,SAAS,yBACR,cACE,IAAI,CAAC,MAAM,CACX,MAAM,CAAC,SAAS,CAChB,KAAK,CAAE,CAAEI,OAAO,CAAE,MAAO,CAAE,CAC3B,EAAE,CAAC,OAAO,CACV,QAAQ,CAAEf,UAAW,EACrB,cACF,KAAC,UAAU,EAAC,OAAO,CAAC,OAAO,uBACzB,YAAK,GAAG,CAAEL,KAAK,CAACF,GAAI,CAAC,GAAG,CAAC,EAAE,EAAG,EACnB,cACb,KAAC,SAAS,EAAC,QAAQ,CAAE,kBAACQ,CAAC,QAAKH,QAAO,CAACG,CAAC,CAACK,MAAM,CAACU,KAAK,CAAC,EAAC,EAAG,cACvD,KAAC,MAAM,EAAC,OAAO,CAAEL,YAAa,UAAC,QAAM,EAAS,GACpC,CACXtB,IAAI,eACH,KAAC,SAAS,EACR,UAAU,CAAE,4BAAMC,QAAO,CAAC,KAAK,CAAC,EAAC,CACjC,WAAW,CAAEK,KAAK,CAACF,GAAI,CACvB,QAAQ,CAAEiB,WAAY,CACtB,QAAQ,CAAEf,KAAK,CAACD,QAAS,EAE5B,GACA,CAEP,CAEA,GAAMuB,UAAS,CAAGjC,MAAM,CAACkC,GAAG,sLAM3B,CAED,GAAMC,WAAU,CAAGnC,MAAM,CAACoC,KAAK,2SAMT,mBAAGC,MAAK,OAALA,KAAK,OAAOA,MAAK,CAACC,MAAM,CAACC,QAAQ,GAQzD,CAED,GAAMC,UAAS,CAAGxC,MAAM,CAACyC,QAAQ,iJAKhC,CAED,cAAerC,SAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}